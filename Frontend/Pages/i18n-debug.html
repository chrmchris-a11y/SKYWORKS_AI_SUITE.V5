<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>i18n Debug Test</title>
    <script src="../i18n/i18n-loader.js?v=20251025-fix"></script>
    <style>
        body { font-family: monospace; padding: 20px; background: #1e1e1e; color: #d4d4d4; }
        .test { margin: 10px 0; padding: 10px; background: #2d2d2d; border-left: 3px solid #007acc; }
        .pass { border-color: #4ec9b0; }
        .fail { border-color: #f48771; }
        h1 { color: #569cd6; }
        pre { background: #1e1e1e; padding: 10px; border: 1px solid #3e3e3e; overflow-x: auto; }
    </style>
</head>
<body>
    <h1>üîç i18n Loader Debug Test</h1>
    <div id="results"></div>

    <script>
        const results = document.getElementById('results');
        
        async function runTests() {
            // Test 1: Check if i18n exists
            addTest('window.i18n exists', typeof window.i18n !== 'undefined');
            
            // Wait for i18n to load
            await new Promise(resolve => {
                if (window.i18n && window.i18n.translations) {
                    resolve();
                } else {
                    document.addEventListener('i18nReady', resolve);
                }
            });

            // Test 2: Check translations loaded
            addTest('Translations loaded', Object.keys(window.i18n.translations).length > 0);
            
            // Test 3: Check missionPlanner exists
            addTest('missionPlanner key exists', 'missionPlanner' in window.i18n.translations);
            
            // Test 4: Check category exists
            const hasCategory = window.i18n.translations.missionPlanner?.category !== undefined;
            addTest('missionPlanner.category exists', hasCategory);
            
            // Test 5: Check SORA-2.5 key
            const hasSora25 = window.i18n.translations.missionPlanner?.category?.['SORA-2.5'] !== undefined;
            addTest('SORA-2.5 key exists', hasSora25);
            
            // Test 6: Try t() function
            const translated = window.i18n.t('missionPlanner.category.SORA-2.5');
            addTest('t() returns value', translated !== 'SORA-2.5');
            
            // Show full path
            addResult('Translation value', translated);
            
            // Show full category object
            addResult('Full category object', JSON.stringify(window.i18n.translations.missionPlanner?.category, null, 2));
            
            // Show all top-level keys
            addResult('Top-level keys', JSON.stringify(Object.keys(window.i18n.translations), null, 2));
        }
        
        function addTest(name, passed) {
            const div = document.createElement('div');
            div.className = 'test ' + (passed ? 'pass' : 'fail');
            div.innerHTML = `<strong>${passed ? '‚úÖ' : '‚ùå'} ${name}</strong>`;
            results.appendChild(div);
        }
        
        function addResult(name, value) {
            const div = document.createElement('div');
            div.className = 'test';
            div.innerHTML = `<strong>${name}:</strong><pre>${value}</pre>`;
            results.appendChild(div);
        }
        
        // Run tests when DOM loads
        if (document.readyState === 'loading') {
            document.addEventListener('DOMContentLoaded', runTests);
        } else {
            runTests();
        }
    </script>
</body>
</html>
